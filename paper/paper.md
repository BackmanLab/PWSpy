---
title: 'PWSpy: A Python library dedicated to the analysis of Partial Wave Spectroscopic Microscopy data.'
tags:
 - Python
 - Microscopy
 - Hyperspectral Imaging
authors:
 - name: Nicholas M. Anthony
   orcid: 0000-0003-2882-2471
   affiliation: 1
affiliations:
 - name: Department of Biomedical Engineering, Northwestern University, Evanston, IL, USA.

date: 10 November 2021
bibliography: paper.bib
---

# Summary

Partial Wave Spectroscopic (PWS) Microscopy is a novel,far-field, spectroscopic microscopy technique that quantitatively 
senses the nanoscale distribution of mass density within a biological sample. PWS does not require exogenous labels and 
thus works even in unstained samples. In addition, because PWS does not rely on fluorescence it is not specific to a 
single labeled molecule.

`PWSpy` is a Python module dedicated to analysis of PWS data. It includes a full suite of tools that prove useful in 
analyzing experimental data, including object-oriented representations of the raw data involved as well as the analyzed output data and auxiliary data used such as ROIs, and automated imaging metadata produced by the PWS Acquisition[@PWS_Acquisition] plugin for Micro-Manager[@Micro-Manager]. With `PWSpy`, it is trivial to skip the basics and get to the heart of extracting meaningful results from your experimental data. Basic operations such as normalization, hardware compensation, and calibration can be handled with the call of a single method. Additionally, the library provides a means for conveniently loading and storing auxiliary data such as ROIs, notes, and analysis outputs. Utility functionality for generating visualizations, automatic colocalization, basic modeling of reflectance, loading of Micro-Manager files, and more are provided in the utility subpackage.


# Statement of need
Any analysis of raw data generated by a PWS experiment or other related imaging modalities[@Gladstein:2019] requires loading image data and metadata from a large variety of file formats and performing complex pre-processing steps before any of the real analysis begins. 
Any minor variations in how this pre-processing is performed can result in major differences in final analysis results and any script that fully implements all of the required processing will be so long as to be unreadable. PWSpy provides an object-oriented interface for performing all common file I/O and analysis tasks related to PWS. 
This allows users to write succinct and readable scripts/software that are guaranteed to perform pre-processing and analysis correctly and which abstracts away the variations in file 
formats between different PWS imaging systems. 

The analysis steps described in previous publications [@cherkezyan:2017, @Gladstein:2019]
can be found written out clearly in Python under the `analysis` package. Support for uniform file handling for 
the current file format used by the PWS Acquisition software[@PWS_Acquisition] as well as all known legacy formats can 
be found under the `dataTypes` package. This library provides the backend code for `PWSpy_GUI`[@PWSpy_GUI]. `PWSpy` was 
designed to be used by any researchers working with PWS data. It has already been
used in one scientific publication [@Li:2021] with many more on the way.

# References