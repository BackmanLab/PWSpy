# PWSpy
A Python module dedicated to analysis of Partial Wave Spectroscopyic Microscopy data.

## Statement of need
Any analysis of raw data generated by PWS and related imaging modes requires loading image data and metadata from a large variety of file formats, performing complex pre-processing steps before any of the real analysis begins. Any minor variations in how this pre-processing is performed can result in major differences in final analysis results. PWSpy provides an object-oriented interface for performing all common file I/O and analysis tasks related to PWS. This allows users to write succinct and readable scripts/software that function identically regardless of the file format of the raw data and which are guaranteed to perform all basic operations properly. The analysis steps described in previous publications ([1](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5348632/), [2](https://www.nature.com/articles/s41467-019-09717-6), [3](https://www.osapublishing.org/ol/viewmedia.cfm?uri=ol-45-17-4810&seq=0&html=true)) can be found written out clearly in Python under the `analysis` package. Classes providing uniform file handling for the current file formats and all known legacy formats can be found under the `dataTypes` package.

## Documentation
API documentation is hosted online at [ReadTheDocs](https://pwspy.readthedocs.io/en/dev/)

## Installation
`PWSpy` is most easily installed with the [Conda](https://docs.conda.io/projects/conda/en/latest/user-guide/install/download.html) package manager.
It is advisable to install `PWSpy` into it's own Conda environment to avoid dependency conflicts. 
Create a new environment with the command: `conda create -n {environmentName} python=3.7`. You can then make the new environment active in your terminal with `conda activate {environmentName}`.

More information [here](https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html).

#### Installing from Anaconda Cloud (recommended)
`PWSpy` is published online to the "backmanlab" Anaconda Cloud channel. It can be installed from Conda with the command `conda install -c conda-forge -c backmanlab pwspy` 

#### Installing Manually
If you have a copy built Conda package (.tar.gz file) then you can install the package with `conda install` like this:
Install the package with `conda install -c file:///{tarGzFileDestination} -c conda-forge pwspy`.

## Building from source and distributing

#### Setting up your computer to build the source code.
First you will need the `Conda` package manager. If you have installed Anaconda then Conda is included.
On Windows you will need to use the `Anaconda Prompt` rather than the default Windows `Command Prompt`.
In addition you will need:  
 - conda-build 
 - anaconda-client 
 - setuptools_scm

These can be installed via: `conda install conda-build anaconda-client setuptools_scm`  

#### Automatic Method (Recommended):
Use the python in your `base` anaconda environment to run `python installScripts\build.py`.
The output will default to `buildscripts/conda/build`. You can optionally provide a custom
output path as the first argument to the `build.py` script. There will be many
files here but the most important one is `build/noarch/pwspy_xxxxxxxxxx.tar.gz`.
This will update the module version in the `_version` file and run the conda-build and deploy steps.
The version number can be understood as `a.b.c.d-xyz` where `a.b.c` are numbers set manually with a Git `Tag`, `d` is the number of commits since 
`a.b.c` was tagged, `xyz` is the short sha hash for the git commit.

#### Uploading a newly built version of the package to Anaconda Cloud
The lab has a `Cloud` account at anaconda.org, the channel name is`backmanlab`.
You can upload the package to the lab's Anaconda Cloud account using `anaconda login` to log into the account and then with `anaconda upload build/noarch/pwspy_xxxxxxxxxx.tar.gz`

## Contributing
Read the [contributing section](CONTRIBUTING.md) in the documentation if you want to help us improve and further develop PWSpy!
